{
    "pluginAlias": "Roomba2",
    "pluginType": "accessory",
    "schema": {
        "type": "object",
        "properties": {
            "name": {
                "type": "string",
                "title": "Name",
                "required": true
            },
            "model": {
                "type": "string",
                "title": "Model",
                "required": true
            },
            "serialnum": {
                "type": "string",
                "title": "Serial Number",
                "required": false
            },
            "blid": {
                "type": "string",
                "title": "blid",
                "required": true
            },
            "robotpwd": {
                "type": "string",
                "title": "Robot Password",
                "required": true
            },
            "ipaddress": {
                "type": "string",
                "title": "IP Address",
                "required": true
            },
            "debug": {
                "type": "boolean",
                "title": "Debug logging",
                "required": false
            },
            "dockContactSensor": {
                "type": "boolean",
                "title": "Home",
                "default": true,
                "required": false
            },
            "runningContactSensor": {
                "type": "boolean",
                "title": "Running",
                "required": false
            },
            "binContactSensor": {
                "type": "boolean",
                "title": "Bin full",
                "required": false
            },
            "dockingContactSensor": {
                "type": "boolean",
                "title": "Returning Home",
                "required": false
            },
            "homeSwitch": {
                "type": "boolean",
                "title": "Home",
                "required": false
            },
            "cleanBehaviour": {
                "type": "string",
                "title": "When Roomba is turned on",
                "required": true,
                "default": "everywhere",
                "oneOf": [
                    { "title": "Clean Everywhere", "enum": ["everywhere"] },
                    { "title": "Specific Rooms", "enum": ["rooms"] }
                ]
            },
            "mission": {
                "type": "object",
                "title": "What rooms should be cleaned",
                "condition": {
                    "functionBody": "return model.cleanBehaviour === 'rooms';"
                },
                "ordered": {
                    "type": "boolean",
                    "title": "Clean rooms in order",
                    "default": true,
                    "required": true
                },
                "pmap_id": {
                    "type": "string",
                    "title": "Pmap Id",
                    "required": {
                        "functionBody": "return model.cleanBehaviour === 'rooms';"
                },
                "regions": {
                    "type": "array",
                    "title": "Regions",
                    "items": [
                        "region_id": {
                            "type": "string",
                            "title": "Region Id"
                        },
                        "type": {
                            "type": "string",
                            "title": "Type",
                            "default": "rid"
                        }
                    ]
                },
                "user_pmapv_id": {
                    "type": "string",
                    "title": "User Pmapv Id",
                    "required": {
                        "functionBody": "return model.cleanBehaviour === 'rooms';"
                    }
                }
            },
            "stopBehaviour": {
                "type": "string",
                "title": "When Roomba is turned off",
                "required": true,
                "default": "home",
                "oneOf": [
                    { "title": "Home", "enum": ["home"] },
                    { "title": "Pause", "enum": ["pause"] }
                ]
            }
        }
    },
    "layout": [
        { "type": "section", "title": "Roomba Details", "items": [ "name", "model", "serialnum", "blid", "robotpwd", "ipaddress" ] },
        { "type": "section", "title": "Contact Sensors", "items": [ "dockContactSensor", "dockingContactSensor", "runningContactSensor", "binContactSensor" ] },
        { "type": "section", "title": "Switches", "items": [ "homeSwitch" ] },
        { "type": "section",
        "title": "Behaviour",
        "items": [ 
            {
                "key": "cleanBehaviour",
                "type": "array",
                "orderable": true,
                "buttonText": "Add Region",
                "items": [
                        {
                            "type": "div",
                            "displayFlex": true,
                            "flex-direction": "row",
                            "items": [
                                {
                                    "key": "regions[].region_id",
                                    "flex": "1 1 50px",
                                    "notitle": true,
                                    "placeholder": "Region Id"
                                },
                                {
                                    "key": "regions[].type",
                                    "flex": "1 1 50px",
                                    "notitle": true,
                                    "placeholder": "Type"
                                }
                            ]
             },
             "stopBehaviour" ] },
        { "type": "section", "title": "Plugin Options", "items": [ "debug" ] }
    ]
}
